Role:
  type: object
  description: |
    Represents a role in the RBAC system. Roles can be assigned to users and
    contain permissions. Default admin-level roles are: SUPER_ADMIN, ADMIN,
    MODERATOR, INSTRUCTOR.
  properties:
    id:
      type: string
      format: uuid
      description: Unique identifier for the role
    name:
      type: string
      description: Role name (e.g., SUPER_ADMIN, ADMIN, MODERATOR, INSTRUCTOR, USER)
    description:
      type: string
      nullable: true
      description: Role description
    isActive:
      type: boolean
      description: Whether the role is active
    createdAt:
      type: string
      format: date-time
      description: When the role was created
    updatedAt:
      type: string
      format: date-time
      description: When the role was last updated
  required:
    - id
    - name
    - isActive

NewRole:
  type: object
  properties:
    name:
      type: string
      minLength: 1
      description: Role name
    description:
      type: string
      description: Role description
  required:
    - name

Permission:
  type: object
  properties:
    id:
      type: string
      format: uuid
      description: Unique identifier for the permission
    name:
      type: string
      description: Permission name
    description:
      type: string
      nullable: true
      description: Permission description
    resource:
      type: string
      enum: [USER, ACCOUNT, SESSION, PROVIDER, ROLE, PERMISSION, COURSE, BLOG, MEDIA]
      description: Resource type
    action:
      type: string
      enum: [CREATE, READ, UPDATE, DELETE, MANAGE]
      description: Action type
    createdAt:
      type: string
      format: date-time
      description: When the permission was created
    updatedAt:
      type: string
      format: date-time
      description: When the permission was last updated
  required:
    - id
    - name
    - resource
    - action

NewPermission:
  type: object
  properties:
    name:
      type: string
      minLength: 1
      description: Permission name
    description:
      type: string
      description: Permission description
    resource:
      type: string
      enum: [USER, ACCOUNT, SESSION, PROVIDER, ROLE, PERMISSION, COURSE, BLOG, MEDIA]
      description: Resource type
    action:
      type: string
      enum: [CREATE, READ, UPDATE, DELETE, MANAGE]
      description: Action type
  required:
    - name
    - resource
    - action

UserRole:
  type: object
  properties:
    id:
      type: string
      format: uuid
      description: Unique identifier for the user role assignment
    userId:
      type: string
      format: uuid
      description: User ID
    roleId:
      type: string
      format: uuid
      description: Role ID
    assignedAt:
      type: string
      format: date-time
      description: When the role was assigned
    assignedBy:
      type: string
      format: uuid
      nullable: true
      description: ID of user who assigned the role
    isActive:
      type: boolean
      description: Whether the role assignment is active
  required:
    - id
    - userId
    - roleId
    - assignedAt
    - isActive

RolePermission:
  type: object
  properties:
    id:
      type: string
      format: uuid
      description: Unique identifier for the role permission assignment
    roleId:
      type: string
      format: uuid
      description: Role ID
    permissionId:
      type: string
      format: uuid
      description: Permission ID
    createdAt:
      type: string
      format: date-time
      description: When the permission was assigned to the role
  required:
    - id
    - roleId
    - permissionId
    - createdAt

RoleAssignment:
  type: object
  properties:
    userId:
      type: string
      format: uuid
      description: User ID
    roleId:
      type: string
      format: uuid
      description: Role ID
  required:
    - userId
    - roleId

PermissionAssignment:
  type: object
  properties:
    roleId:
      type: string
      format: uuid
      description: Role ID
    permissionId:
      type: string
      format: uuid
      description: Permission ID
  required:
    - roleId
    - permissionId

UserPermissions:
  type: object
  description: |
    Contains the user's roles and aggregated permissions. Note that userId here
    refers to the local database ID, not the Supabase Auth ID. Use the
    /auth/get-local-user-id endpoint to map between them.
  properties:
    userId:
      type: string
      format: uuid
      description: User ID (local database ID, not Supabase Auth ID)
    roles:
      type: array
      items:
        $ref: '#/components/schemas/Role'
      description: User's roles
    permissions:
      type: array
      items:
        $ref: '#/components/schemas/Permission'
      description: User's permissions

RolesResponse:
  type: object
  properties:
    roles:
      type: array
      items:
        $ref: '#/components/schemas/Role'

PermissionsResponse:
  type: object
  properties:
    permissions:
      type: array
      items:
        $ref: '#/components/schemas/Permission'

RoleResponse:
  type: object
  properties:
    roleId:
      type: string
      format: uuid
      description: Created role ID
    message:
      type: string
      description: Success message

PermissionResponse:
  type: object
  properties:
    permissionId:
      type: string
      format: uuid
      description: Created permission ID
    message:
      type: string
      description: Success message

AdminRoleCheckResponse:
  type: object
  description: Response from admin role check endpoint
  properties:
    hasAdminRole:
      type: boolean
      description: Whether the user has any admin-level role (SUPER_ADMIN, ADMIN, MODERATOR, INSTRUCTOR)
    roles:
      type: array
      items:
        type: string
      description: List of active role names for the user
      example: ["SUPER_ADMIN"]
    localUserId:
      type: string
      format: uuid
      description: User ID in the local database
    error:
      type: string
      description: Error message if check failed
  required:
    - hasAdminRole

LocalUserIdResponse:
  type: object
  description: Response from local user ID lookup endpoint
  properties:
    localUserId:
      type: string
      format: uuid
      description: User ID in the local database mapped from Supabase Auth ID
    error:
      type: string
      description: Error message if lookup failed
