/rbac/roles:
  get:
    tags:
      - RBAC
      - Roles
    summary: Get all roles
    description: Retrieve all available roles
    security:
      - sessionAuth: []
    responses:
      200:
        description: Roles retrieved successfully
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RolesResponse'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      500:
        $ref: '#/components/responses/ServerError'

  post:
    tags:
      - RBAC
      - Roles
    summary: Create a new role
    description: Create a new role with specified permissions
    security:
      - sessionAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/NewRole'
    responses:
      201:
        description: Role created successfully
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RoleResponse'
      400:
        $ref: '#/components/responses/ValidationError'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      409:
        description: Role already exists
        content:
          application/json:
            schema:
              type: object
              properties:
                error:
                  type: string
                  example: "Role already exists"
      500:
        $ref: '#/components/responses/ServerError'

/rbac/permissions:
  get:
    tags:
      - RBAC
      - Permissions
    summary: Get all permissions
    description: Retrieve all available permissions
    security:
      - sessionAuth: []
    responses:
      200:
        description: Permissions retrieved successfully
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PermissionsResponse'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      500:
        $ref: '#/components/responses/ServerError'

  post:
    tags:
      - RBAC
      - Permissions
    summary: Create a new permission
    description: Create a new permission for a specific resource and action
    security:
      - sessionAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/NewPermission'
    responses:
      201:
        description: Permission created successfully
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PermissionResponse'
      400:
        $ref: '#/components/responses/ValidationError'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      409:
        description: Permission already exists
        content:
          application/json:
            schema:
              type: object
              properties:
                error:
                  type: string
                  example: "Permission already exists"
      500:
        $ref: '#/components/responses/ServerError'

/rbac/roles/{roleId}/permissions:
  post:
    tags:
      - RBAC
      - Roles
      - Permissions
    summary: Assign permission to role
    description: Assign a permission to a specific role
    security:
      - sessionAuth: []
    parameters:
      - name: roleId
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Role ID
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              permissionId:
                type: string
                format: uuid
                description: Permission ID to assign
            required:
              - permissionId
    responses:
      200:
        description: Permission assigned to role successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Permission assigned to role successfully"
      400:
        $ref: '#/components/responses/ValidationError'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      404:
        $ref: '#/components/responses/NotFoundError'
      500:
        $ref: '#/components/responses/ServerError'

  delete:
    tags:
      - RBAC
      - Roles
      - Permissions
    summary: Remove permission from role
    description: Remove a permission from a specific role
    security:
      - sessionAuth: []
    parameters:
      - name: roleId
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Role ID
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              permissionId:
                type: string
                format: uuid
                description: Permission ID to remove
            required:
              - permissionId
    responses:
      200:
        description: Permission removed from role successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Permission removed from role successfully"
      400:
        $ref: '#/components/responses/ValidationError'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      404:
        $ref: '#/components/responses/NotFoundError'
      500:
        $ref: '#/components/responses/ServerError'

/rbac/users/{userId}/roles:
  get:
    tags:
      - RBAC
      - Users
    summary: Get user roles and permissions
    description: Retrieve all roles and permissions for a specific user
    security:
      - sessionAuth: []
    parameters:
      - name: userId
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: User ID
    responses:
      200:
        description: User permissions retrieved successfully
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPermissions'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      404:
        $ref: '#/components/responses/NotFoundError'
      500:
        $ref: '#/components/responses/ServerError'

  post:
    tags:
      - RBAC
      - Users
    summary: Assign role to user
    description: Assign a role to a specific user
    security:
      - sessionAuth: []
    parameters:
      - name: userId
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: User ID
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              roleId:
                type: string
                format: uuid
                description: Role ID to assign
            required:
              - roleId
    responses:
      200:
        description: Role assigned to user successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Role assigned to user successfully"
      400:
        $ref: '#/components/responses/ValidationError'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      404:
        $ref: '#/components/responses/NotFoundError'
      500:
        $ref: '#/components/responses/ServerError'

  delete:
    tags:
      - RBAC
      - Users
    summary: Remove role from user
    description: Remove a role from a specific user
    security:
      - sessionAuth: []
    parameters:
      - name: userId
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: User ID
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              roleId:
                type: string
                format: uuid
                description: Role ID to remove
            required:
              - roleId
    responses:
      200:
        description: Role removed from user successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Role removed from user successfully"
      400:
        $ref: '#/components/responses/ValidationError'
      401:
        $ref: '#/components/responses/UnauthorizedError'
      403:
        $ref: '#/components/responses/ForbiddenError'
      404:
        $ref: '#/components/responses/NotFoundError'
      500:
        $ref: '#/components/responses/ServerError'
