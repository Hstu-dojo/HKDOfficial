// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "cockroachdb"
  url      = env("DATABASE_URL")
}

// run `npx prisma generate` to generate ERD diagram
generator markdown {
  provider = "prisma-markdown"
  output   = "../public/erd/ERD.md"
  title    = "HSTU Karate Dojo"
}


// create enumeration of roles
enum Roletype {
  ADMIN
  HR
  EMPLOYEE
  GUEST
}
enum IdentityType {
  NID
  BIRTH_CERTIFICATE
  PASSPORT
  DRIVING_LICENSE
}


model Account {
  id                 String  @id @default(sequence())
  userId             String  @unique
  name               String
  name_bangla        String
  father_name        String
  image              String
  avatar             String?
  bio                String?
  sex                String
  dob                DateTime
  phone              String
  address            String
  city               String
  state              String
  country            String
  postalCode         String
  age                Int
  bloodGroup         String
  height             Float
  weight             Float
  occupation         String
  identity_type      IdentityType
  identity_number    String
  identity_image     String?
  institute          String
  faculty            String?
  department         String?
  session            String?
  signature_image    String


  
  user User @relation(fields: [userId], references: [id])
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  @@map("account")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String @unique
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model User {
  id            String    @id @default(cuid())
  email         String    @unique
  emailVerified Boolean?  @default(false)
  password      String
  account       Account?
  sessions      Session?
  providers     Provider[]
  role          Role[]
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  @@map("user")
  @@index([email], name: "email")
  
}

model Provider {
  id                 String   @id @default(cuid())
  userId             String
  provider           String
  providerAccountId  String
  refresh_token      String?  
  access_token       String?  
  expires_at         Int?
  token_type         String?
  scope              String?
  id_token           String?  
  session_state      String?


  @@unique([provider, providerAccountId])
  @@map("provider")
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  user         User     @relation(fields: [userId], references: [id])
}

model Role{
  id            String    @id @default(cuid())
  role Roletype @default(GUEST)
  levelId String

  level Level?
  user User @relation(fields: [id], references: [id])
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  @@map("role")

}
model Level{
  id            String    @id @default(cuid())
  levelName String

  features String[]
  role Role @relation(fields: [id], references: [id])

  @@map("level")
}


model VerificationToken {
  id         String   @id @default(cuid())
  email      String
  token      String   @default(uuid())
  validity   Int      @default(1)
 
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}